#include <stdio.h>
#include <stdlib.h>

struct employee {
    int emp_id;
    char name[20];
    float salary;
};

int main() {
    FILE *fp;
    struct employee emp;
    int choice, id, found = 0;

    fp = fopen("emp.dat", "rb+");
    if (fp == NULL) {
        fp = fopen("emp.dat", "wb+");  // Create file if not exists
    }

    do {
        printf("\n--- Employee File Menu ---\n");
        printf("1. Add Employee\n");
        printf("2. Display All Employees\n");
        printf("3. Search Employee by ID\n");
        printf("4. Exit\n");
        printf("Enter choice: ");
        scanf("%d", &choice);

        switch (choice) {

        case 1:
            printf("Enter Employee ID: ");
            scanf("%d", &emp.emp_id);
            printf("Enter Name: ");
            scanf("%s", emp.name);
            printf("Enter Salary: ");
            scanf("%f", &emp.salary);

            fseek(fp, 0, SEEK_END);
            fwrite(&emp, sizeof(emp), 1, fp);
            printf("Employee record added\n");
            break;

        case 2:
            rewind(fp);
            printf("\nID\tName\tSalary\n");
            while (fread(&emp, sizeof(emp), 1, fp)) {
                printf("%d\t%s\t%.2f\n", emp.emp_id, emp.name, emp.salary);
            }
            break;

        case 3:
            printf("Enter Employee ID to search: ");
            scanf("%d", &id);
            rewind(fp);
            found = 0;

            while (fread(&emp, sizeof(emp), 1, fp)) {
                if (emp.emp_id == id) {
                    printf("\nEmployee Found:\n");
                    printf("ID: %d\nName: %s\nSalary: %.2f\n",
                           emp.emp_id, emp.name, emp.salary);
                    found = 1;
                    break;
                }
            }
            if (!found)
                printf("Employee not found\n");
            break;

        case 4:
            printf("Exiting...\n");
            break;

        default:
            printf("Invalid choice\n");
        }

    } while (choice != 4);

    fclose(fp);
    return 0;
}
